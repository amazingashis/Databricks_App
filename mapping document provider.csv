Source Table,Source Column,Transformation / Mapping Rules,Field,Array Field
provider_drname,nationalid,nationalid,service_provider_id,
provider_drname,dr_no_ext,dr_no_ext,source_service_provider_id,
provider_drname,dr_fname,dr_fname,name_first_name,
provider_drname,dr_iname,dr_iname,name_middle_name,
provider_drname,dr_lname,dr_lname,name_last_name,
provider_drname,drsal,drsal,name_prefix_name,
provider_drname,drsuffix,drsuffix,name_suffix_name,
provider_drname,"drsal, 
dr_fname ,
dr_iname, 
dr_lname,
drsuffix","trim(concat(coalesce(drsal,"" ""),coalesce(dr_fname ,"" ""),coalesce(dr_iname,"" ""),coalesce(dr_lname,"" ""),coalesce(drsuffix,"" ""))",alternate_name_name,
provider_address1,,"lit(""physical"")",address_address_type,
provider_addr_arr,txt," when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Home Address"",              
                            ""Home""                          
                        ),
                        lit(""home"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Part Time Clinic"",
                            ""MFC Part Time Clinic Bill"",
                            ""MFC W-9 Address"",
                            ""MFC Hospitalist Address  "",
                            ""MFC Mailing Address"",
                            ""MFC Primary Office Address"",
                            ""MFC Previous Address"",
                            ""MFC Previous Billing Address"",
                            ""MFC Credentialing Address"",
                            ""MedStar Inpatient Term Address"",
                            ""Prov Group Contract Address"",
                            ""MFC Urgent Care Part Time"",
                            ""MedStar Inpatient Location"",
                            ""MFC Practice Location"",
                            ""MFC Telemedicine Address"",
                            ""Provider Group Previous Add"",
                            ""Additional Office"",
                            ""Primary"",
                            ""Prov Grp Mailing Addr"",
                            ""Prov Grp Addr"",
                            ""Primary Organization"",
                        ),
                        lit(""work"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Billing Address"",
                            ""MedStar Inpatient Billing"",
                            ""PHO-Fourth Billing Address"",
                            ""Billing"",
                            ""Mailing"",
                            ""Prov Grp Bill Addr"",
                            ""Prov Grp IRS Addr""
                        ),
                        lit(""billing"").alias(""address_use"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""UNSPECIFIED""                            
                        ),
                        lit(""temp"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Do Not Print"",
                            ""Previous Billing Address"",
                            ""Previous Billing Org"",
                            ""Previous Office Address"",
                            ""Previous"",
                        ),
                        lit(""old"")
                    ).otherwise(
                        lit(None)
                    )",address_address_use,
provider_address1,addr,,address_address_line_1,
provider_address1,addr2,,address_address_line_2,
provider_address1,city,,address_city,
provider_address1,county,,address_county,
provider_address1,state,,address_state_province,
provider_address1,zip,,address_postal_code,
provider_address1,zip_extension,,address_zip_code_extension,
provider_address1,nation,,address_country,
provider_address1,longitude,,address_longitude,
provider_address1,latitude,,address_latitude,
provider_address1,effdate,,address_eff_date,
provider_address1,termdate,,address_exp_date,
,,,address_confidential_status,
provider_address1,loc_code,,address_locality_code,
"provider_address1
provider_insur","txt
cd
addr
addr2
city
county
state
zip
zip_extension
nation
longitude
latitude
effdate
termdate
handicap","sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""physical"").alias(""address_type""), # default address_type is physical and there is no PO or BOX in address description to map as postal
                    when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Home Address"",              
                            ""Home""                          
                        ),
                        lit(""home"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Part Time Clinic"",
                            ""MFC Part Time Clinic Bill"",
                            ""MFC W-9 Address"",
                            ""MFC Hospitalist Address  "",
                            ""MFC Mailing Address"",
                            ""MFC Primary Office Address"",
                            ""MFC Previous Address"",
                            ""MFC Previous Billing Address"",
                            ""MFC Credentialing Address"",
                            ""MedStar Inpatient Term Address"",
                            ""Prov Group Contract Address"",
                            ""MFC Urgent Care Part Time"",
                            ""MedStar Inpatient Location"",
                            ""MFC Practice Location"",
                            ""MFC Telemedicine Address"",
                            ""Provider Group Previous Add"",
                            ""Additional Office"",
                            ""Primary"",
                            ""Prov Grp Mailing Addr"",
                            ""Prov Grp Addr"",
                            ""Primary Organization"",
                        ),
                        lit(""work"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Billing Address"",
                            ""MedStar Inpatient Billing"",
                            ""PHO-Fourth Billing Address"",
                            ""Billing"",
                            ""Mailing"",
                            ""Prov Grp Bill Addr"",
                            ""Prov Grp IRS Addr""
                        ),
                        lit(""billing"").alias(""address_use"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""UNSPECIFIED""                            
                        ),
                        lit(""temp"")
                    ).when(
                        col(""addr_arr_df__txt"").isin(
                            ""MFC Do Not Print"",
                            ""Previous Billing Address"",
                            ""Previous Billing Org"",
                            ""Previous Office Address"",
                            ""Previous"",
                        ),
                        lit(""old"")
                    ).otherwise(
                        lit(None)
                    ).alias(""address_use""),
                    col(""address1_df__addr"").alias(""address_line_1""),
                    col(""address1_df__addr2"").alias(""address_line_2""),
                    col(""address1_df__city"").alias(""city""),
                    col(""address1_df__county"").alias(""county""),
                    col(""address1_df__state"").alias(""state_province""),
                    col(""address1_df__zip"").alias(""postal_code""),
                    col(""address1_df__zip_extension"").alias(""zip_code_extension""),
                    col(""address1_df__nation"").alias(""country""),
                    col(""address1_df__longitude"").alias(""longitude""),
                    col(""address1_df__latitude"").alias(""latitude""),
                    col(""address1_df__effdate"").alias(""eff_date""),
                    col(""address1_df__termdate"").alias(""exp_date""),
                    col(""address1_df__status"").alias(""confidential_status""),
                    col(""address1_df__handicap"").alias(""is_handicap_accessible""),
                    col(""address1_df__loc_code"").alias(""locality_code""),
                    col(""addr_arr_df__cd"").alias(""address_sch_type""),
                    when(col(""address1_df__udf3"") == 'Y',lit(True))
                        .when(col(""address1_df__udf3"") == 'N',lit(False))
                        .otherwise(lit(None)).alias(""print_in_directory_ind"")
                )
            ), asc = False
        )
Note: generated_address_reference_id logic available in 'Reference_ID_logic' Tab

Adding insurance addresses:
    sort_array(
        collect_set(
            struct(
                lit(3).alias(""address_sort""),
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""Insurance"").alias(""address_type""),
                lit(""Insurance"").alias(""address_use""),
                col(""insur_df__addr"").alias(""address_line_1""),
                col(""insur_df__addr2"").alias(""address_line_2""),
                col(""insur_df__city"").alias(""city""),
                lit(None).alias(""county""),
                col(""insur_df__state"").alias(""state_province""),
                substring(col(""insur_df__zip""), 1, 5).alias(""postal_code""),
                substring(col(""insur_df__zip""), 7, 4).alias(""zip_code_extension""),
                col(""insur_df__nation"").alias(""country""),
                col(""insur_df__longitude"").alias(""longitude""),
                col(""insur_df__latitude"").alias(""latitude""),
                lit(None).alias(""eff_date""),
                lit(None).alias(""exp_date""),
                lit(None).alias(""confidential_status""),
                lit(None).alias(""is_handicap_accessible""),
                lit(None).alias(""locality_code""),
                lit(None).alias(""address_sch_type""),
                lit(None).alias(""print_in_directory_ind"")
            )
        ), asc = True
    ).alias(""other_addresses_insur"")
",other_addresses,"reference_id
address_type
address_attn_care_of
address_use
address_line_1
address_line_2
address_line_3
entity_type
quadrant
ward
city
county
state_province
postal_code
zip_code_extension
country
longitude
latitude
eff_date
exp_date
confidential_status
validation_status
address_source
is_handicap_accessible
locality_code
print_in_directory_ind
"
provider_address1,phone,,primary_phone_number,
,,,secondary_phone_number,
provider_address1,,"sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""phone"").alias(""phone_type""),
                    col(""address1_df__phone"").alias(""number""),
                    lit(None).alias(""country_code""),
                    lit(None).alias(""area_code""),
                    col(""address1_df__extension"").alias(""extension""),
                    lit(None).alias(""confidential_status"")
                )
            ), asc = False
    )

Note: generated_address_reference_id logic available in 'Reference_ID_logic' Tab",other_phones,"reference_id
phone_type
number
country_code
area_code
extension
confidential_status
source
"
provider_drname,email,,email_email,
provider_drname,"email, appmodule_email","sort_array(
        concat(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),            
                    lit(""URL"").alias(""email_type""),
                    col(""drname_df__email"").alias(""email""),
                    lit(None).alias(""confidential_status"")
                    )
                ),
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),            
                    lit(""App_Module"").alias(""email_type""),
                    col(""drname_df__appmodule_email"").alias(""email""),
                    lit(None).alias(""confidential_status"")
                )
            )
        ))
",other_emails,"reference_id
email_type
email
confidential_status
validation_status
source
"
"provider_addr_arr. provider_address1,
provider_school
",,"ADDRESS
sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id""),
                    lit(None).alias(""entity_type""),
                    col(""address1_df__fax"").alias(""telecom_value""),
                    lit(""fax"").alias(""telecom_type""),
                    lit(None).alias(""telecom_use""),
                    lit(None).alias(""telecom_rank""),
                    lit(None).alias(""telecom_eff_date""),
                    lit(None).alias(""telecom_exp_date""),
                    lit(None).alias(""contact_name""),
                    lit(None).alias(""contact_address""),
                    lit(None).alias(""contact_telecom_value""),
                    lit(None).alias(""contact_telecom_type""),
                    lit(None).alias(""available_all_day""),
                    lit(""sun"").alias(""available_days_of_week""),
                    when(col(""address1_df__sun_s1"") != """", col(""address1_df__sun_s1"")).otherwise(col(""address1_df__sun_s2"")).alias(""available_start_time""),
                    when(col(""address1_df__sun_e1"") != """", col(""address1_df__sun_e1"")).otherwise(col(""address1_df__sun_e2"")).alias(""available_end_time""),
                    lit(None).alias(""intemediary_ind""),
                    lit(None).alias(""intermediary_value""),
                    lit(None).alias(""intermediary_type"")
                )
            ), asc = False
        ).alias(""Sunday""),
     sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id""),
                    lit(None).alias(""entity_type""),
                    col(""address1_df__fax"").alias(""telecom_value""),
                    lit(""fax"").alias(""telecom_type""),
                    lit(None).alias(""telecom_use""),
                    lit(None).alias(""telecom_rank""),
                    lit(None).alias(""telecom_eff_date""),
                    lit(None).alias(""telecom_exp_date""),
                    lit(None).alias(""contact_name""),
                    lit(None).alias(""contact_address""),
                    lit(None).alias(""contact_telecom_value""),
                    lit(None).alias(""contact_telecom_type""),
                    lit(None).alias(""available_all_day""),
                    lit(""mon"").alias(""available_days_of_week""),
                    when(col(""address1_df__mon_s1"") != """", col(""address1_df__mon_s1"")).otherwise(col(""address1_df__mon_s2"")).alias(""available_start_time""),
                    when(col(""address1_df__mon_e1"") != """", col(""address1_df__mon_e1"")).otherwise(col(""address1_df__mon_e2"")).alias(""available_end_time""),
                    lit(None).alias(""intemediary_ind""),
                    lit(None).alias(""intermediary_value""),
                    lit(None).alias(""intermediary_type"")
                )
            ), asc = False
        ).alias(""Monday""),
     sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id""),
                    lit(None).alias(""entity_type""),
                    col(""address1_df__fax"").alias(""telecom_value""),
                    lit(""fax"").alias(""telecom_type""),
                    lit(None).alias(""telecom_use""),
                    lit(None).alias(""telecom_rank""),
                    lit(None).alias(""telecom_eff_date""),
                    lit(None).alias(""telecom_exp_date""),
                    lit(None).alias(""contact_name""),
                    lit(None).alias(""contact_address""),
                    lit(None).alias(""contact_telecom_value""),
                    lit(None).alias(""contact_telecom_type""),
                    lit(None).alias(""available_all_day""),
                    lit(""tue"").alias(""available_days_of_week""),
                    when(col(""address1_df__tues_s1"") != """", col(""address1_df__tues_s1"")).otherwise(col(""address1_df__tues_s2"")).alias(""available_start_time""),
                    when(col(""address1_df__tues_e1"") != """", col(""address1_df__tues_e1"")).otherwise(col(""address1_df__tues_e2"")).alias(""available_end_time""),
                    lit(None).alias(""intemediary_ind""),
                    lit(None).alias(""intermediary_value""),
                    lit(None).alias(""intermediary_type"")
                )
            ), asc = False
        ).alias(""Tuesday""),
     sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id""),
                    lit(None).alias(""entity_type""),
                    col(""address1_df__fax"").alias(""telecom_value""),
                    lit(""fax"").alias(""telecom_type""),
                    lit(None).alias(""telecom_use""),
                    lit(None).alias(""telecom_rank""),
                    lit(None).alias(""telecom_eff_date""),
                    lit(None).alias(""telecom_exp_date""),
                    lit(None).alias(""contact_name""),
                    lit(None).alias(""contact_address""),
                    lit(None).alias(""contact_telecom_value""),
                    lit(None).alias(""contact_telecom_type""),
                    lit(None).alias(""available_all_day""),
                    lit(""wed"").alias(""available_days_of_week""),
                    when(col(""address1_df__wednes_s1"") != """", col(""address1_df__wednes_s1"")).otherwise(col(""address1_df__wednes_s2"")).alias(""available_start_time""),
                    when(col(""address1_df__wednes_e1"") != """", col(""address1_df__wednes_e1"")).otherwise(col(""address1_df__wednes_e2"")).alias(""available_end_time""),
                    lit(None).alias(""intemediary_ind""),
                    lit(None).alias(""intermediary_value""),
                    lit(None).alias(""intermediary_type"")
                )
            ), asc = False
        ).alias(""Wednesday""),
     sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id""),
                    lit(None).alias(""entity_type""),
                    col(""address1_df__fax"").alias(""telecom_value""),
                    lit(""fax"").alias(""telecom_type""),
                    lit(None).alias(""telecom_use""),
                    lit(None).alias(""telecom_rank""),
                    lit(None).alias(""telecom_eff_date""),
                    lit(None).alias(""telecom_exp_date""),
                    lit(None).alias(""contact_name""),
                    lit(None).alias(""contact_address""),
                    lit(None).alias(""contact_telecom_value""),
                    lit(None).alias(""contact_telecom_type""),
                    lit(None).alias(""available_all_day""),
                    lit(""thu"").alias(""available_days_of_week""),
                    when(col(""address1_df__thurs_s1"") != """", col(""address1_df__thurs_s1"")).otherwise(col(""address1_df__thurs_s2"")).alias(""available_start_time""),
                    when(col(""address1_df__thurs_e1"") != """", col(""address1_df__thurs_e1"")).otherwise(col(""address1_df__thurs_e2"")).alias(""available_end_time""),
                    lit(None).alias(""intemediary_ind""),
                    lit(None).alias(""intermediary_value""),
                    lit(None).alias(""intermediary_type"")
                )
            ), asc = False
        ).alias(""Thursday""),
     sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id""),
                    lit(None).alias(""entity_type""),
                    col(""address1_df__fax"").alias(""telecom_value""),
                    lit(""fax"").alias(""telecom_type""),
                    lit(None).alias(""telecom_use""),
                    lit(None).alias(""telecom_rank""),
                    lit(None).alias(""telecom_eff_date""),
                    lit(None).alias(""telecom_exp_date""),
                    lit(None).alias(""contact_name""),
                    lit(None).alias(""contact_address""),
                    lit(None).alias(""contact_telecom_value""),
                    lit(None).alias(""contact_telecom_type""),
                    lit(None).alias(""available_all_day""),
                    lit(""fri"").alias(""available_days_of_week""),
                    when(col(""address1_df__fri_s1"") != """", col(""address1_df__fri_s1"")).otherwise(col(""address1_df__fri_s2"")).alias(""available_start_time""),
                    when(col(""address1_df__fri_e1"") != """", col(""address1_df__fri_e1"")).otherwise(col(""address1_df__fri_e2"")).alias(""available_end_time""),
                    lit(None).alias(""intemediary_ind""),
                    lit(None).alias(""intermediary_value""),
                    lit(None).alias(""intermediary_type"")
                )
            ), asc = False
        ).alias(""Friday""),
     sort_array(
            collect_list(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id""),
                    lit(None).alias(""entity_type""),
                    col(""address1_df__fax"").alias(""telecom_value""),
                    lit(""fax"").alias(""telecom_type""),
                    lit(None).alias(""telecom_use""),
                    lit(None).alias(""telecom_rank""),
                    lit(None).alias(""telecom_eff_date""),
                    lit(None).alias(""telecom_exp_date""),
                    lit(None).alias(""contact_name""),
                    lit(None).alias(""contact_address""),
                    lit(None).alias(""contact_telecom_value""),
                    lit(None).alias(""contact_telecom_type""),
                    lit(None).alias(""available_all_day""),
                    lit(""sat"").alias(""available_days_of_week""),
                    when(col(""address1_df__satur_s1"") != """", col(""address1_df__satur_s1"")).otherwise(col(""address1_df__satur_s2"")).alias(""available_start_time""),
                    when(col(""address1_df__satur_e1"") != """", col(""address1_df__satur_e1"")).otherwise(col(""address1_df__satur_e2"")).alias(""available_end_time""),
                    lit(None).alias(""intemediary_ind""),
                    lit(None).alias(""intermediary_value""),
                    lit(None).alias(""intermediary_type"")
                )
            ), asc = False
        ).alias(""Saturday"")
)

SCHOOL
concat(
            sort_array(
                collect_list(
                    struct(
                        lit(None).alias(""reference_id""),
                        lit(None).alias(""id""),
                        lit(""School"").alias(""entity_type""),
                        lit(None).alias(""telecom_value""),
                        lit(None).alias(""telecom_type""),
                        lit(None).alias(""telecom_use""),
                        lit(None).alias(""telecom_rank""),
                        lit(None).alias(""telecom_eff_date""),
                        lit(None).alias(""telecom_exp_date""),
                        col(""school_df__contact1"").alias(""contact_name""),
                        lit(None).alias(""contact_address""),
                        lit(None).alias(""contact_telecom_value""),
                        lit(None).alias(""contact_telecom_type""),
                        lit(None).alias(""available_all_day""),
                        lit(None).alias(""available_days_of_week""),
                        lit(None).alias(""available_start_time""),
                        lit(None).alias(""available_end_time""),
                        lit(None).alias(""intemediary_ind""),
                        lit(None).alias(""intermediary_value""),
                        lit(None).alias(""intermediary_type"")
                    )
                ), asc = False
            ),
             sort_array(
                collect_list(
                    struct(
                        lit(None).alias(""reference_id""),
                        lit(None).alias(""id""),
                        lit(""School"").alias(""entity_type""),
                        lit(None).alias(""telecom_value""),
                        lit(None).alias(""telecom_type""),
                        lit(None).alias(""telecom_use""),
                        lit(None).alias(""telecom_rank""),
                        lit(None).alias(""telecom_eff_date""),
                        lit(None).alias(""telecom_exp_date""),
                        col(""school_df__contact2"").alias(""contact_name""),
                        lit(None).alias(""contact_address""),
                        lit(None).alias(""contact_telecom_value""),
                        lit(None).alias(""contact_telecom_type""),
                        lit(None).alias(""available_all_day""),
                        lit(None).alias(""available_days_of_week""),
                        lit(None).alias(""available_start_time""),
                        lit(None).alias(""available_end_time""),
                        lit(None).alias(""intemediary_ind""),
                        lit(None).alias(""intermediary_value""),
                        lit(None).alias(""intermediary_type"")
                    )
                ), asc = False
            )
        )

",general_contact_details,"reference_id
id
entity_type
telecom_value
telecom_type
telecom_use
telecom_rank
eff_date
exp_date
contact_name
contact_name_use
contact_name_prefix
contact_first_name
contact_middle_name
contact_last_name
contact_name_suffix
contact_address
contact_telecom_value
contact_telecom_type
contact_purpose
contact_purpose_system
contact_purpose_display
available_all_day
available_days_of_week
available_start_time
available_end_time
intermediary_ind
intermediary_id
intermediary_type
intermediary_contact_value
intermediary_contact_type
"
,,"lit(""Facebook"")",social_profile_social_profile_type,
"avesis_provider_medstardc_medicaid_vision,avesis_provider_medstardc_medicaid_dental, avesis_provider_medstar_medicaid_vision
",facebook,,social_profile_profile_url,
provider_drname,,"sort_array(
            concat(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),            
                    lit(""Facebook"").alias(""type""),
                    col(""drname_df__facebook"").alias(""url""),
                    lit(None).alias(""active_profile"")
                )
            ),
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),            
                    lit(""Twitter"").alias(""type""),
                    col(""drname_df__twitter"").alias(""url""),
                    lit(None).alias(""active_profile"")
                )
            )
        ))
",other_social_profiles,"reference_id
type
url
active_profile
source
"
provider_drname,gender,,base_demographic_gender,
provider_stfstatu,pcp_spec,"if len(pcp_ind_array) == 1:
        pcp_ind_code = pcp_ind_array[0]
        if pcp_ind_code == ""P"":
            pcp_ind= True
        elif pcp_ind_code == ""S"":
            pcp_ind= False
        elif pcp_ind_code == ""B"":
            pcp_ind= True
        else:
            service_provider_role = None
    elif len(pcp_ind_array) > 1:
        pcp_ind = True

Note: 
pcp_ind_arry:  list of provider_stfstatu.pcp_spec",pcp_ind,
provider_stfstatu,pcp_spec,"if len(pcp_ind_array) == 1:
        pcp_ind_code = pcp_ind_array[0]
        if pcp_ind_code == ""P"":
            service_provider_role = ""PCP""
        elif pcp_ind_code == ""S"":
            service_provider_role = ""Specialist""
        elif pcp_ind_code == ""B"":
            service_provider_role = ""Both PCP and Specialist""
        else:
            service_provider_role = None
    elif len(pcp_ind_array) > 1:
        service_provider_role = ""Both PCP and Specialist""

Note: 
pcp_ind_arry:  list of provider_stfstatu.pcp_spec",service_provider_role,
provider_u3_tab,txt,"sort_array(
        collect_set(
            when(col(""u3_tab_df__txt"") == 'Accepting New Patients', lit('Accepting New Patients'))
                .when(col(""u3_tab_df__txt"") == 'Not Accepting New Patients', lit('Not Accepting New Patients'))
            .otherwise(lit(None))
            ), asc = False)",accept_new_patient,
provider_u3_tab,txt,"sort_array(
        collect_set(
            when(col(""u3_tab_df__txt"") == 'Accepting New Patients', lit(None))
                .when(col(""u3_tab_df__txt"") == 'Not Accepting New Patients', lit(None))
            .otherwise(col(""u3_tab_df__txt""))            
            ), asc = False
    )",accept_new_patient_from_network,
provider_drname,gender,,base_demographic_gender,
,,,base_demographic_sex,
provider_drname,ud12,,base_demographic_race,
,,,base_demographic_religion,
provider_drname,ethnic,,base_demographic_ethnicity,
provider_drname,marital,,base_demographic_marital_status,
provider_drname,citisen,,base_demographic_nationality,
,,,base_demographic_mothers_maiden_name,
"provider_drname
",citisen,"col(""drname_df__citisen"").alias(""base_demographic_citizenship""",base_demographic_citizenship,
provider_drname,ss_no,,national_id,
provider_drname,nationalid,,npi,
,,,dea_id,
provider_address2,substring_tax_id,,tin,
,,,practice_type,
,," lit(""True"")",active,
provider_drname,birthdate,,birth_date_of_birth,
provider_drname,birthdate,year(birthdate),birth_year_of_birth,
provider_drname,birthplace,,birth_birthplace,
,,,deceased_deceased_ind,
,,,deceased_deceased_date,
provider_drname,lan_cd,,language_language_code,
"provider_dr_lan,
provider_lan_tab",,"sort_array(
        collect_list(
            struct(
                lit(None).alias(""reference_id""),
                col(""dr_lan_df__lan_cd"").alias(""language_code""),
                col(""lan_tab_df__txt"").alias(""language_code_display""),
                lit(None).alias(""language_text""),
                col(""dr_lan_df__seq"").alias(""language_proficiency""),
            )
        ), asc=True
    )
",other_languages,"reference_id
language_code
language_code_display
language_text
language_proficiency
usage
usage_source
source
"
,,,privacy_preferences,"reference_id
opt_out
allowed_to_contact
contact_party
email_opt_out
mail_opt_out
phone_opt_out
text_message_opt_out
"
"provider_credent
provider_statelic
provider_lic_arr
provider_taxonomy
provider_stfstatu
provider_dr_spec
provider_drname",,"status_udf22_qualifications
 sort_array(
            collect_set(
                struct(
                    lit(None).alias(""reference_id""),                   
                    lit(None).alias(""board_id""),
                    lit(None).alias(""certificate_id""),
                    lit(""Flouride Varnish"").alias(""description""), 
                    lit(None).alias(""issue_date""),
                    lit(None).alias(""exp_date""), 
                    lit(None).alias(""issuer""),
                    lit(None).alias(""issuer_display""),                   
                    lit(None).alias(""jurisdiction""),
                    lit(None).alias(""license_category""),
                    lit(None).alias(""license_number""), 
                    lit(None).alias(""qualification_code""),
                    lit(""udf22"").alias(""qualification_code_display""), 
                    lit(None).alias(""qualification_code_system""),
                    col(""drname_df__npdb"").alias(""qualification_number""), 
                    col(""drname_df__npdbdesc"").alias(""qualification_type""),
                    lit(None).alias(""renew_date""), 
                    lit(None).alias(""setting_type""),
                    col(""stfstatu_df__udf22"").alias(""status""),
                    col(""taxonomy_df__cd"").alias(""taxonomy"")
                    )
                ), asc = False
            )

status_udf21_qualifications
sort_array(
                collect_set(
                    struct(
                        lit(None).alias(""reference_id""),                   
                        lit(None).alias(""board_id""),
                        lit(None).alias(""certificate_id""),                        
                        lit(""DC Health Check"").alias(""description""), 
                        lit(None).alias(""issue_date""),
                        lit(None).alias(""exp_date""), 
                        lit(None).alias(""issuer""),
                        lit(None).alias(""issuer_display""),                   
                        lit(None).alias(""jurisdiction""),
                        lit(None).alias(""license_category""),
                        lit(None).alias(""license_number""), 
                        lit(None).alias(""qualification_code""),
                        lit(""udf21"").alias(""qualification_code_display""), 
                        lit(None).alias(""qualification_code_system""),
                        col(""drname_df__npdb"").alias(""qualification_number""), 
                        col(""drname_df__npdbdesc"").alias(""qualification_type""),
                        lit(None).alias(""renew_date""), 
                        lit(None).alias(""setting_type""),
                        col(""stfstatu_df__udf21"").alias(""status""),
                        col(""taxonomy_df__cd"").alias(""taxonomy"")
                        )
                    ), asc = False
                )

status_udf1_qualifications
 sort_array(
                collect_set(
                    struct(
                        lit(None).alias(""reference_id""),                   
                        lit(None).alias(""board_id""),
                        lit(None).alias(""certificate_id""),
                        lit(""EPDST"").alias(""description""), 
                        lit(None).alias(""issue_date""),
                        lit(None).alias(""exp_date""), 
                        lit(None).alias(""issuer""),
                        lit(None).alias(""issuer_display""),                   
                        lit(None).alias(""jurisdiction""),
                        lit(None).alias(""license_category""),
                        lit(None).alias(""license_number""), 
                        lit(None).alias(""qualification_code""),
                        lit(""udf1"").alias(""qualification_code_display""), 
                        lit(None).alias(""qualification_code_system""),
                        col(""drname_df__npdb"").alias(""qualification_number""), 
                        col(""drname_df__npdbdesc"").alias(""qualification_type""),
                        lit(None).alias(""renew_date""), 
                        lit(None).alias(""setting_type""),
                        col(""stfstatu_df__udf1"").alias(""status""),
                        col(""taxonomy_df__cd"").alias(""taxonomy"")
                        )
                    ), asc = False
                )

dr_spec_tab_join_qualifications
sort_array(
        collect_set(
            struct(
                lit(None).alias(""reference_id""),                   
                lit(None).alias(""board_id""),
                lit(None).alias(""certificate_id""),
                lit(""Board Certified"").alias(""description""), 
                col(""dr_spec_df__year_cert"").cast(StringType()).alias(""issue_date""),
                lit(None).alias(""exp_date""), 
                lit(None).alias(""issuer""),
                lit(None).alias(""issuer_display""),                   
                lit(None).alias(""jurisdiction""),
                lit(None).alias(""license_category""),
                lit(None).alias(""license_number""), 
                lit(None).alias(""qualification_code""),
                lit(None).alias(""qualification_code_display""), 
                lit(None).alias(""qualification_code_system""),
                col(""drname_df__npdb"").alias(""qualification_number""), 
                col(""drname_df__npdbdesc"").alias(""qualification_type""),
                col(""dr_spec_df__year_recert"").cast(StringType()).alias(""renew_date""), 
                lit(None).alias(""setting_type""),
                col(""dr_spec_df__bd_cert"").cast(StringType()).alias(""status""),
                col(""taxonomy_df__cd"").alias(""taxonomy"")
                )
            ), asc = False
        )

credent_lic_arr_statelic_qualifications
sort_array(
        collect_set(
            struct(
                lit(None).alias(""reference_id""),                   
                lit(None).alias(""board_id""),
                lit(None).alias(""certificate_id""),
                col(""credent_df__title"").alias(""description""), 
                col(""credent_df__issue_dt"").alias(""issue_date""),
                col(""credent_df__lic_date"").alias(""exp_date""), 
                col(""statelic_df__txt"").alias(""issuer""),
                col(""statelic_df__cd"").alias(""issuer_display""),                   
                lit(None).alias(""jurisdiction""),
                col(""lic_arr_df__cd"").alias(""license_category""),
                col(""credent_df__lic_num"").alias(""license_number""), 
                lit(None).alias(""qualification_code""),
                lit(None).alias(""qualification_code_display""), 
                col(""lic_arr_df__txt"").alias(""qualification_code_system""),
                col(""drname_df__npdb"").alias(""qualification_number""), 
                col(""drname_df__npdbdesc"").alias(""qualification_type""),
                lit(None).alias(""renew_date""), 
                lit(None).alias(""setting_type""),
                col(""credent_df__status"").alias(""status""),
                col(""taxonomy_df__cd"").alias(""taxonomy"")
                )
            ), asc = False
        )

drname_ud8_qualifications
sort_array(
        collect_set(
            struct(
                lit(None).alias(""reference_id""),                   
                lit(None).alias(""board_id""),
                lit(None).alias(""certificate_id""),
                lit(""Cultural Competency Training"").alias(""description""), 
                lit(None).alias(""issue_date""),
                lit(None).alias(""exp_date""), 
                lit(None).alias(""issuer""),
                lit(None).alias(""issuer_display""),                   
                lit(None).alias(""jurisdiction""),
                lit(None).alias(""license_category""),
                lit(None).alias(""license_number""), 
                lit(None).alias(""qualification_code""),
                lit(""ud8"").alias(""qualification_code_display""), 
                lit(None).alias(""qualification_code_system""),
                col(""drname_df__npdb"").alias(""qualification_number""), 
                col(""drname_df__npdbdesc"").alias(""qualification_type""),
                lit(None).alias(""renew_date""), 
                lit(None).alias(""setting_type""),
                col(""drname_df__ud8"").alias(""status""),
                col(""taxonomy_df__cd"").alias(""taxonomy"")
                )
            ), asc = False
        )
",qualifications,"reference_id
board_id
certificate_id
description
issue_date
exp_date
issuer
issuer_display
jurisdiction
license_category
license_number
qualification_code
qualification_code_display
qualification_code_system
qualification_number
qualification_type
renew_date
setting_type
status
taxonomy
"
,,,credentialing_practice_type,
,,,credentialing_practice_status,
,,,credentialing_provider_status,
,,,credentialing_provider_type,
"provider_educate,
provider_educate_arr,
provider_school",,"sort_array(
        collect_set(
            struct(
                lit(None).alias(""reference_id""),                   
                lit(None).alias(""cumulative_years_of_training""),
                col(""educate_df__degree"").alias(""degree""),
                col(""educ_arr_df__txt"").alias(""education_type""), 
                year(col(""educate_df__tdate"")).alias(""end_year""),
                col(""school_df__subname"").alias(""department""),
                lit(None).alias(""gpa""), 
                lit(None).alias(""active""),
                lit(None).alias(""graduated_ind""),                   
                col(""school_df__txt"").alias(""school_name""),
                year(col(""educate_df__fdate"")).alias(""start_year""),
                lit(None).alias(""year_of_graduation""), 
                lit(None).alias(""years_in_program"")
                )
            ), asc = False
        )

",education,"reference_id
cumulative_years_of_training
degree
education_type
end_year
field_of_study
department
gpa
active
graduated_ind
school_name
start_year
year_of_graduation
years_in_program
"
,,,reviews,"reference_id
review_action
date_and_time_of_review
date_and_time_of_review_end
description
restriction_end_date
restriction_start_date
review_received_date
review_restriction_type
review_type
"
,,,provider_participating_code,
provider_dr_plan1,,"struct(
                md5(
                    concat(
                        coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                        coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                        coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                    )).alias(""reference_id""),           
                col(""dr_plan1_df__plan_cd"").alias(""plan_id""),
                col(""ins_plan_df__txt"").alias(""name""),            
                col(""ins_plan_df__subname"").alias(""type""),
                col(""dr_plan1_df__l_par_code"").alias(""parent_payer_network""),            
                col(""dr_plan1_df__vstart"").alias(""eff_date""),
                col(""dr_plan1_df__eend"").alias(""exp_date""),
                lit(None).alias(""participation_code""), 
                lit(None).alias(""payer_network_name"")
                )
            ), asc = False

        )
",networks,"reference_id
id
plan_id
name
type
parent_payer_network
eff_date
exp_date
participation_code
payer_network_name
"
,,,network_tiers,"reference_id
network_id
id
type
level
eff_date
exp_date
"
,,,fee_variation_value,
provider_spec_tab,,"    sort_array(
        collect_set(
            struct(
                lit(None).alias(""reference_id""),                   
                lit(None).alias(""id""),
                lit(None).alias(""type""),
                lit(None).alias(""type_desc""), 
                col(""spec_tab_df__cd"").alias(""code_value""),
                col(""spec_tab_df__txt"").alias(""specialty_description""), 
                lit(None).alias(""vendor_name""),
                col(""dr_spec_df__primspec"").alias(""primary_ind"")
                )
            ), asc = False",specialty,"reference_id
id
type
type_desc
code_value
specialty_description
vendor_name
primary_ind
"
,,,eft,"reference_id
eff_date
exp_date
account_number
aba_routing_number
account_type
account_version"
,,,provider_endpoint,
provider_addr_arr,"txt,cd"," sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    col(""addr_arr_df__txt"").alias(""id_type""),
                    col(""addr_arr_df__cd"").alias(""id_value""),
                    lit(None).alias(""id_concept""),
                    lit(None).alias(""id_status""),
                    lit(""cd"").alias(""input_field_name"")
                )
            ), asc = False
        )
",reference_ids,"reference_id
id_type
id_value
id_concept
id_status
input_field_name"
"provider_drname,
provider_stfstatu,
provider_dr_expert,
provider_ educ_tab,
provider_loc_tab ,
provider_plan1_u3ins 
",,"status_active_variable
sort_array(
        collect_list(
            struct(
                lit(None).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Active123"").alias(""code_type""),
                col(""stfstatu_df__active123"").alias(""code_value""),
                col(""rec_arr_df__txt"").alias(""code_description"")
                )
            ), asc=False

status_udf1_variable
sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(""udf1"").alias(""code_id""),
                lit(""EPSDT"").alias(""code_type""),
                lit(""stfstatu_df__udf1"").alias(""code_value""),
                when(col(""stfstatu_df__udf1"")=='1',lit('MD Medicaid EPSDT Certified'))
                     .when(col(""stfstatu_df__udf1"")=='2',lit('DO NOT USE DC Medicaid EPSDT'))
                     .when(col(""stfstatu_df__udf1"")=='3',lit('DO NOT USE MD&DC Medicaid EPSDT'))
                     .when(col(""stfstatu_df__udf1"")=='NOC',lit('Not Certified'))
                     .when(col(""stfstatu_df__udf1"")=='CE',lit('Certification Ended'))
                     .when(col(""stfstatu_df__udf1"")=='NA',lit('N/A')).otherwise(lit('')).alias(""code_description"")
            )
            ), asc=False
        )

status_udf21_variable
   sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(""udf21"").alias(""code_id""),
                lit(""DC Healthcheck"").alias(""code_type""),
                lit(""stfstatu_df__udf21"").alias(""code_value""),
                when(col(""stfstatu_df__udf21"")=='1',lit('DC Healthcheck EPSDT Certified'))
                     .when(col(""stfstatu_df__udf21"")=='NOC',lit('Not Certified'))
                     .when(col(""stfstatu_df__udf21"")=='NA',lit('N/A')).otherwise(lit('')).alias(""code_description"")
            )
            ), asc=False
        )

status_udf22_variable
 sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(""udf22"").alias(""code_id""),
                lit(""Flouride Varnish"").alias(""code_type""),
                lit(""stfstatu_df__udf22"").alias(""code_value""),
                when(col(""stfstatu_df__udf22"")=='TNC',lit('Training Not Completed'))
                     .when(col(""stfstatu_df__udf22"")=='NOC',lit('Not Certified'))
                     .when(col(""stfstatu_df__udf22"")=='NA',lit('N/A')).otherwise(lit('')).alias(""code_description"")
            )
            ), asc=False
        )

sta_tab_variable
 sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Record Status"").alias(""code_type""),
                col(""sta_tab_df__cd"").alias(""code_value""),
                col(""sta_tab_df__txt"").alias(""code_description"")
            )
            ), asc=False
        )

drname_ethinic_variable
sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Ethinicity"").alias(""code_type""),
                col(""drname_df__ethnic"").alias(""code_value""),
                when(col(""drname_df__ethnic"")=='4',lit('Hispanic or Latino'))
                     .when(col(""drname_df__ethnic"")=='NHL',lit('Non-Hispanic or Non-Latino'))
                     .when(col(""drname_df__ethnic"")=='PNA',lit('Declined')).otherwise(lit('')).alias(""code_description"")
            )
            ), asc=False
        )

drname_race_variable
sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Race"").alias(""code_type""),
                col(""drname_df__ud12"").alias(""code_value""),
                when(col(""drname_df__ud12"")=='A',lit('Asian'))
                     .when(col(""drname_df__ud12"")=='AIA',lit('American Indian/Alaska Native'))
                     .when(col(""drname_df__ud12"")=='BAA',lit('Black/African American'))
                     .when(col(""drname_df__ud12"")=='HL',lit('Hispanic or Latino'))
                     .when(col(""drname_df__ud12"")=='NH',lit('Native Hawaiian/Other Pacific Islander'))
                     .when(col(""drname_df__ud12"")=='PNA',lit('Declined'))
                     .when(col(""drname_df__ud12"")=='U',lit('Some Other Race'))
                     .when(col(""drname_df__ud12"")=='WC',lit('White/Caucasian')).otherwise(lit('')).alias(""code_description"")
            )
            ), asc=False
        )

drname_fmg_variable
sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""FMG"").alias(""code_type""),
                col(""drname_df__fmg"").cast(StringType()).alias(""code_value""),
                lit(""Qualification Type/Status"").alias(""code_description"")
            )
            ), asc=False
        )

drplan1_u3ins_variable
sort_array(
        collect_list(
            struct(
                md5(
                    concat(
                        coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                        coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                        coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                    )).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Plan Term Reason"").alias(""code_type""),
                col(""u3ins_tb_df__cd"").alias(""code_value""),
                col(""u3ins_tb_df__txt"").alias(""code_description"")            
            )
            ), asc=False
        )

loc_tab_cd_variable
sort_array(
        collect_list(
            struct(
                md5(
                concat(
                    coalesce(col(""address1_df__dr_id""),lit('NA')),
                    coalesce(col(""address1_df__sch_type""),lit('NA')),
                    coalesce(col(""address1_df__addr""),lit('NA')),
                    coalesce(col(""address1_df__addr2""),lit('NA')),
                    coalesce(col(""address1_df__city""),lit('NA')),
                    coalesce(col(""address1_df__state""),lit('NA')),
                    coalesce(col(""address1_df__zip""),lit('NA')),
                    coalesce(col(""address1_df__link""),lit('NA'))
                )).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Location"").alias(""code_type""),
                col(""loc_tab_df__cd"").alias(""code_value""),
                col(""loc_tab_df__txt"").alias(""code_description"")
            )
        ), asc = False
    )

educ_tab_cd_variable
sort_array(
            collect_list(
                struct(
                        lit(None).alias(""reference_id""),
                        lit(None).alias(""code_id""),
                        lit(""Education"").alias(""code_type""),
                        col(""educ_tab_df__cd"").alias(""code_value""),
                        col(""educ_tab_df__txt"").alias(""code_description"")
                     )
            ), asc=False
        )

dr_expert_expertise_variable
sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Expertise"").alias(""code_type""),
                col(""dr_expert_df__expertise"").alias(""code_value""),
                col(""exp_tab_df__txt"").alias(""code_description"")
            )
            ), asc=False
        )

drname_pract_variable
sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(None).alias(""code_id""),
                lit(""Practice Code"").alias(""code_type""),
                col(""drname_df__pract_cd1"").cast(StringType()).alias(""code_value""),
                col(""par_tab_df__txt"").alias(""code_description"")
            )
            ), asc=False
        )
",variable_fields,"reference_id
code_id
code_type
code_value
code_description"
"provider_sta_tab ,",,,source_extension_record_id,"reference_id
source_table_name
abacus_record_id"
,,,original_source_value,
,,"lit(""HERO"")",source_name,
"provider_drname,
",dr_id,,source_id,
,,,source_authoritative_ind,
,,,source_timestamp,
"provider_drname,
",abacus_source_file,,source_file_name,
"provider_drname,
provider_stfstatu",,"VISA
 sort_array(
        collect_list(
     struct(
            lit(None).alias(""reference_id""),
            lit(""Visa"").alias(""identifier_type""),
            col(""drname_df__visa"").alias(""identifier""),
            lit(""DrName"").alias(""identifier_source""),
            lit(None).alias(""eff_date""),            col(""drname_df__expdate"").cast(StringType()).alias(""exp_date"")            
        ),
   ))

UPIN
sort_array(
        collect_list(
            struct(
            lit(None).alias(""reference_id""),
            lit(""UPIN"").alias(""identifier_type""),
            col(""drname_df__upin"").alias(""identifier""),
            lit(""DrName"").alias(""identifier_source""),
            lit(None).alias(""exp_date""),
            lit(None).alias(""eff_date"")
        ),
        ))
NUDF1
sort_array(
        collect_list(
     struct(
            lit(None).alias(""reference_id""),
            lit(""CAQH"").alias(""identifier_type""),
            col(""drname_df__nudf1"").alias(""identifier""),
            lit(""DrName"").alias(""identifier_source""),
            lit(None).alias(""exp_date""),
            lit(None).alias(""eff_date"")
        ),
        ))
EFMGNO
sort_array(
        collect_list(
     struct(
            lit(None).alias(""reference_id""),
            lit(""efmg number"").alias(""identifier_type""),
            col(""drname_df__efmg_no"").alias(""identifier""),
            lit(""DrName"").alias(""identifier_source""),
            lit(None).alias(""exp_date""),
            lit(None).alias(""eff_date"")
        )
        ))
STFSTATU 
map_concat(
            col(""status_medicare_identifiers""),
            col(""status_medicaid_identifiers"")
        )
 
 sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(""Drname_Medicare"").alias(""identifier_type""),
drname_medicare_identifiers col(""drname_df__medicare"").alias(""identifier""),
                lit(""drname"").alias(""identifier_source""),
                lit(None).alias(""exp_date""),
                lit(None).alias(""eff_date"")

            )

            ), asc=False
        )
drname_medicaid_identifiers
 sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(""Drname_Medicaid"").alias(""identifier_type""),
                col(""drname_df__medicaid"").alias(""identifier""),
                lit(""drname"").alias(""identifier_source""),
                lit(None).alias(""exp_date""),
                lit(None).alias(""eff_date"")
            )
            ), asc=False 
drname_npi_identifiers
sort_array(
        collect_list(
        struct(
                lit(None).alias(""reference_id""),
                lit(""NPI"").alias(""identifier_type""),
                col(""drname_df__nationalid"").alias(""identifier""),         
                lit(""NPI"").alias(""identifier_source""),
                lit(None).alias(""exp_date""),
                lit(None).alias(""eff_date"")
            )
            ), asc=False ),

Practice Limitations Handicap
sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""Practice Limitations Handicap"").alias(""identifier_type""),
                    col(""address1_usr_df__UsrField_2"").alias(""identifier""),
                    lit(""UsrField_2"").alias(""identifier_source""),
                    lit(None).alias(""exp_date""),
                    lit(None).alias(""eff_date"")
                )
            ), asc=False
         ).alias(""practice_limitations_handicap_identifiers""),
Practice Limitations Office Hours
        sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""Practice Limitations Office Hours"").alias(""identifier_type""),
                    col(""address1_usr_df__UsrField_3"").alias(""identifier""),
                    lit(""UsrField_3"").alias(""identifier_source"")  ,
                    lit(None).alias(""exp_date""),
                    lit(None).alias(""eff_date"")
                )
            ), asc=False
        ).alias(""practice_limitations_office_hours_identifiers""),
",identifiers,"reference_id
identifier_type
identifier
identifier_source
eff_date
exp_date
standard_id
id_check_digit
organization
last_update_date
id_status
"
,,,additional_source_identifiers,
"
provider_stfstatu,
provider_address1,
provider_credent,
provider_educate,
provider_drname,
provider_u1_tab,
provider_u_tab,
provider_insur,
provider_carry",,"""drname_verfac_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Verfac"""").alias(""""source_column_name""""),
                    col(""""drname_df__verfac"""").cast(""""string"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

drname_title_extension
 sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Dr_Title"""").alias(""""source_column_name""""),
                    col(""""drname_df__drtitle"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

drname_ud1_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""Min_Patient_Age"""").alias(""""source_column_name""""),
                col(""""u1_tab_df__txt"""").alias(""""source_column_value"""")
            )
        ), asc = False
    )

drname_ud2_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""Max_Patient_Age"""").alias(""""source_column_name""""),
                col(""""u2_tab_df__txt"""").alias(""""source_column_value"""")
            )
        ), asc = False
    )

drname_ud13_date_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""ud13_date"""").alias(""""source_column_name""""),
                col(""""drname_df__ud13_date"""").alias(""""source_column_value"""")
            )
        ), asc = False
    )

drname_ud14_date_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""ud14_date"""").alias(""""source_column_name""""),
                col(""""drname_df__ud14_date"""").alias(""""source_column_value"""")
            )
        ), asc = False
    )

drname_ud15_date_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""ud15_date"""").alias(""""source_column_name""""),
                col(""""drname_df__ud15_date"""").alias(""""source_column_value"""")
            )
        ), asc = False
    )

drname_df__pict1
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),
                    lit(""pict1"").alias(""source_column_name""),
                    col(""drname_df__pict1"").cast(""string"").alias(""source_column_value"")
                )
            ), asc = False


drname_df__ud7
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),
                    lit(""ud7"").alias(""source_column_name""),
                    col(""drname_df__ud7"").cast(""string"").alias(""source_column_value"")
                )
            ), asc = False


drname_ud7_date_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),
                    lit(""ud7_date"").alias(""source_column_name""),
                    col(""drname_df__ud7_date"").cast(""date"").alias(""source_column_value"")
                )
            ), asc = False


drname_pict2_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),
                    lit(""pict2"").alias(""source_column_name""),
                    col(""drname_df__pict2"").cast(""string"").alias(""source_column_value"")
                )
            ), asc = False


drname_ud3_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),
                    lit(""ud3"").alias(""source_column_name""),
                    col(""drname_df__ud3"").cast(""string"").alias(""source_column_value"")
                )
            ), asc = False


drname_ud9_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),
                    lit(""ud9"").alias(""source_column_name""),
                    when(col(""drname_df__ud9"")== ""C"", lit(""1099/Contracted"")).when(col(""drname_df__ud9"")== ""E"",lit(""W-2/Employed"")).otherwise(col(""drname_df__ud9"")).cast(""string"").alias(""source_column_value"")
                )
            ), asc = False



status_rec_date_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""Rec_Date"""").alias(""""source_column_name""""),
                col(""""stfstatu_df__rec_date"""").alias(""""source_column_value"""")
                )
            ), asc=False
        )

address_county_extension
sort_array(
            collect_list(
                struct(
                    col(""""address_reference_id"""").alias(""""reference_id""""),
                    lit(""""County_Code"""").alias(""""source_column_name""""),
                    col(""""address1_df__countycd"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

address_link_extension
sort_array(
            collect_list(
                struct(
                    col(""""address_reference_id"""").alias(""""reference_id""""),
                    lit(""""Address_Link"""").alias(""""source_column_name""""),
                    col(""""address1_df__link"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

educate_code_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Educate_Code"""").alias(""""source_column_name""""),
                    col(""""educate_df__cd"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

educate_cmt1_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""reference_id""),
                    lit(""cmt1"").alias(""source_column_name""),
                    col(""educate_df__cmt1"").alias(""source_column_value"")
                )
            ), asc = False


educate_link_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Educate_Link"""").alias(""""source_column_name""""),
                    col(""""educate_df__link"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

credent_code_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Credent_Code"""").alias(""""source_column_name""""),
                    col(""""credent_df__cd"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

credent_link_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Credent_Link"""").alias(""""source_column_name""""),
                    col(""""credent_df__link"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

drname_beeper_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Beeper"""").alias(""""source_column_name""""),
                    col(""""drname_df__beeper"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

drname_beeper2_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""Beeper2"""").alias(""""source_column_name""""),
                    col(""""drname_df__beeper2"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

school_code_extension
sort_array(
            collect_list(
                struct(
                    lit(None).alias(""""reference_id""""),
                    lit(""""School_Code"""").alias(""""source_column_name""""),
                    col(""""school_df__cd"""").alias(""""source_column_value"""")
                )
            ), asc = False
        )

drplan1_status_extension
sort_array(
        collect_set(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""Plan_Status"""").alias(""""source_column_name""""),
                col(""""dr_plan1_df__status"""").alias(""""source_column_value"""")
                )
            ), asc=False
    )

drplan1_pcp_spec_extension
sort_array(
        collect_set(
            struct(
                lit(None).alias(""reference_id""),
                lit(""pcp_spec"").alias(""source_column_name""),
                col(""dr_plan1_df__pcp_spec"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""drplan1_pcp_spec_extension"")

status_rea_date_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""Rea_Date"""").alias(""""source_column_name""""),
                col(""""stfstatu_df__rea_date"""").alias(""""source_column_value"""")
                )
            ), asc=False
        )

status_l_secfile_extension
sort_array(
        collect_list(
            struct(
                lit(None).alias(""""reference_id""""),
                lit(""""l_secfile"""").alias(""""source_column_name""""),
                col(""""stfstatu_df__l_secfile"""").alias(""""source_column_value"""")
                )
            ), asc=False
    )
DR_PLAN2_FROM_DATE_EXTENSION
sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""Dr Plan2 From Date"").alias(""source_column_name""),
                col(""dr_plan2_df__from_date"").cast(""string"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""dr_plan2_from_date_extension""),
DR_PLAN2_TO_DATE_EXTENSION
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""Dr Plan2 To Date"").alias(""source_column_name""),
                col(""dr_plan2_df__to_date"").cast(""string"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""dr_plan2_to_date_extension""),
DR_PLAN2_PANEL_STATUS_EXTENSION
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""Dr Plan2 Panel Status"").alias(""source_column_name""),
                col(""dr_plan2_df__open_c"").cast(""string"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""dr_plan2_panel_status_extension""),
DR_PLAN2_FACILITY_NETWORK_EXTENSION
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""Dr Plan2 Facility Network"").alias(""source_column_name""),
                col(""dr_plan2_df__l_indc_tb1"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""dr_plan2_facility_network_extension""),
DR_PLAN2_SPECIALTY_CATEGORY_EXTENSION
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""Dr Plan2 Specialty Category"").alias(""source_column_name""),
                col(""dr_plan2_df__l_spec_tb1"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""dr_plan2_specialty_category_extension"")
sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""Services Offered Code"").alias(""source_column_name""),
                    col(""addrservices_df__service_cd"").alias(""source_column_value"")
                )
            ), asc=False
        ).alias(""address1_services_offered_code_extension""),
        sort_array(
            collect_set(
                struct(
                    concat(col(""address1_df__dr_id""),lit(""_""),col(""address_reference_id"")).alias(""reference_id""),
                    lit(""Public Transportation"").alias(""source_column_name""),
                    col(""address1_df__pubtrans"").cast(""String"").alias(""source_column_value"")
                    )
                ), asc=False
        ).alias(""address1_public_transportation_extension""),
        sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""Ward"").alias(""source_column_name""),
                    when(col(""address1_df__county"").ilike(""ward%""),regexp_extract(col(""address1_df__county""), r'Ward\s*(\d+)', 1)).alias(""source_column_value"")
                )
            ), asc=False
        ).alias(""address1_ward_extension""),
        sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""Local Access Area"").alias(""source_column_name""),
                    col(""local_access_area_df__laa"").alias(""source_column_value"")
                )
            ), asc=False
        ).alias(""laa_extension""),
        sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""PCP Assign Panel Code"").alias(""source_column_name""),
                    col(""address1_df__udf1"").alias(""source_column_value"")
                )
            ), asc=False
        ).alias(""address1_pcp_assign_panel_code_extension""),
sort_array(
            collect_set(
                struct(
                    col(""address_reference_id"").alias(""reference_id""),
                    lit(""Name On Card"").alias(""source_column_name""),
                    col(""address1_df__udf2"").alias(""source_column_value"")
                )
            ), asc=False
        ).alias(""address1_name_on_card_extension""),
sort_array(
            collect_set(
                struct(
                    col(""drname_df__dr_id"").alias(""reference_id""),
                    lit(""Notes"").alias(""source_column_name""),
                    col(""drname_df__notes"").alias(""source_column_value"")
                )
            ), asc = False
        ).alias(""drname_df__notes_extension""),
sort_array(
        collect_set(
            struct(
                col(""stfstatu_df__dr_id"").alias(""reference_id""),
                lit(""Has PCP Spec"").alias(""source_column_name""),
                col(""stfstatu_df__pcp_spec"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""status_pcp_spec_extension""),
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit("""")),
                    coalesce(col(""carry_df__sch_type"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""pic_eff_date"").alias(""source_column_name""),
                col(""carry_df__enroll_dt"").alias(""source_column_value""),
            )
        )
    ).alias(""provider_insurance_coverages_eff_date""),
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""pic_exp_date"").alias(""source_column_name""),
                col(""carry_df__expdate"").alias(""source_column_value""),
            )
        )
    ).alias(""provider_insurance_coverages_exp_date""),
        sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                 lit(""pic_policy_id"").alias(""source_column_name""),
                col(""carry_df__policy_no"").alias(""source_column_value"")
            )
        )
    ).alias(""provider_insurance_coverages_policy_id""),
        sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""contact_1"").alias(""source_column_name""),
                col(""insur_df__contact1"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""insur_contact_extension""),
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""fax"").alias(""source_column_name""),
                col(""insur_df__fax"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""insur_fax_extension""),
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""cover"").alias(""source_column_name""),
                col(""carry_df__cover"").alias(""source_column_value"")
                )
            ), asc=False
    ).alias(""cover_extension""),
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""carry_sch_type"").alias(""source_column_name""),
                col(""carry_df__sch_type"").alias(""source_column_value"")
            )
        ), asc=False
    ).alias(""carry_sch_type""),  
    sort_array(
        collect_set(
            struct(
                concat(
                    coalesce(col(""dr_plan1_df__dr_id""), lit("""")),
                    lit(""_""),
                    coalesce(col(""dr_plan1_df__plan_cd""), lit("""")),
                    coalesce(col(""dr_plan1_df__vstart"").cast(""string""), lit("""")),
                    coalesce(col(""dr_plan1_df__eend"").cast(""string""), lit(""""))
                ).alias(""reference_id""),
                lit(""insur_coverage_name"").alias(""source_column_name""),
                col(""insur_df__txt"").alias(""source_column_value"")
            )
        ), asc = False
    ).alias(""associated_insurance_plans_coverage_name""),

""",extension_source_values,"reference_id
source_column_name
source_column_value
"
,,"Data is populated based on DQ rules which has been set while mapping



",data_quality_result,"severe_count
warning_count
severe_errors
warning_errors
"
